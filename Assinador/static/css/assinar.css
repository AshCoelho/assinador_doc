:root{
  --brand:#0d6efd;
  --border:rgba(0,0,0,.12);
  --surface:#fff;
  --muted:#6c757d;
  --shadow:0 1px 2px rgba(0,0,0,.06), 0 6px 24px rgba(0,0,0,.06);
}

/* Header */
.app-header{display:flex;align-items:center;justify-content:center;width:100%;margin-top:1.5rem;margin-bottom:.5rem}
.app-title{display:flex;align-items:center;gap:.5rem;font-weight:700;color:var(--brand);font-size:clamp(1.2rem,2.2vw,1.6rem)}
.text-end,.text-end-1{display:flex;width:100%;justify-content:space-between;align-items:center}
.text-end-1{justify-content:flex-end}
.usuario{margin-right:.75rem;font-size:clamp(.95rem,1.6vw,1rem)}

/* Área de visualização – realmente fluida */
#canvasContainer{
  position: relative;
  background: #f8f9fa;
  border: 1px dashed var(--border);
  border-radius: .15rem;
  padding: 8px;

  /* limites universais */
  max-width: 1100px;      
  margin: 0 auto;
  max-height: 82vh;
  overflow: auto;
}


/* ====== CANVASES ====== */
/* Deixe o JS controlar display (block/none). Sem !important. */
#canvasContainer canvas{
  display: none;
  margin: 0 auto;
  background: #fff;
  box-shadow: 0 1px 2px rgba(0,0,0,.03);
  /* não force width 100% aqui */
}

#canvasContainer canvas.active{
  display: block;
}
/* Quando preenchido, mantenha limites e rolagem (não solte overflow) */
#canvasContainer.filled{
  background: transparent;
  border: none;
  padding: 0 !important;
  max-width: 1100px;     
  margin: 0 auto;
  max-height: 82vh !important;
  overflow: auto !important;
}


/* O retângulo é absoluto em relação ao #stage */
#stage{
  position: relative;
  display: block;
  width: 100% !important;
  height: auto !important;
  margin: 0 auto;
  z-index: 5;
}

/* Canvas respeita o cap do container sem esticar além do necessário */
#stage canvas{
  display: block;
  max-width: 100%;  
  height: auto;     
}


#canvasContainer.filled #stage{
  margin: 0 auto;           
}
/* carimbo acima do canvas */
.retangulo{ z-index: 20; }

/* alças de resize */
.retangulo .handle{
  position:absolute; width:14px; height:14px; background:#0d6efd;
  border:2px solid #fff; border-radius:50%; box-shadow:0 1px 3px rgba(0,0,0,.25);
}
.handle.br{ right:-8px; bottom:-8px; cursor:se-resize; }
.handle.tr{ right:-8px; top:-8px;    cursor:ne-resize; }
.handle.bl{ left:-8px;  bottom:-8px; cursor:sw-resize; }
.handle.tl{ left:-8px;  top:-8px;    cursor:nw-resize; }

/* Carimbo (posição/tamanho definidos por ratio via JS) */
.retangulo{
  touch-action: none;
  position:absolute;
  border:2px dashed var(--brand);
  border-radius:.5rem;
  background:rgba(13,110,253,.08);
  box-shadow:0 4px 18px rgba(38,136,228,.2);
  cursor:move; user-select:none;
  display:none;
  min-width:96px;            
  min-height:72px;
  touch-action:none;          
  -webkit-tap-highlight-color: transparent;
}


/* Garanta que clique/toque “chegue” no carimbo */
.retangulo {
    touch-action: none;
    -webkit-user-select: none;
    user-select: none;
  }

.retangulo .stamp-content{
  pointer-events:auto !important;
  display:flex;flex-direction:column;justify-content:center;align-items:center;
  height:100%;padding:.5rem .75rem;text-align:center;color:#0d6efd;
  line-height:1.25;font-size:clamp(.75rem,1.5vw,.95rem);
}
.retangulo .stamp-title{font-weight:700;margin-bottom:.25rem;color:#0948c5}

/* Resultado */
.viewer{border:1px solid var(--border);border-radius:10px;background:#fff;padding:8px;margin-top:16px}
.pdf-frame{width:100%;height:clamp(56vh,70vh,82vh);border:none;border-radius:8px}
.img-preview{max-width:100%;height:auto;border-radius:8px;display:block;margin:0 auto}

/* Barra de centralização */
.center-bar{display:flex;flex-wrap:wrap;gap:.5rem;margin-bottom:.75rem}
.center-bar .btn{display:flex;align-items:center;gap:.5rem; justify-content: space-between;}
.flex-wrap{display:flex;flex-wrap: wrap; font-size:.95rem;width: 100%;max-width: 500px; justify-content: space-between; }


/* --- DESKTOP: limite real do editor (≥992px) --- */
@media (min-width: 992px){
  /* Canvas: controlado pelo JS. Evite !important aqui. */
#canvasContainer canvas{
  display: none;
  margin: 0 auto;
  background: #fff;
  box-shadow: 0 1px 2px rgba(0,0,0,.03);
  visibility: visible; /* não esconda por visibility */
}

#canvasContainer canvas.active{
  display: block;
}

/* Canvas nunca estoura o container; encolhe se precisar */
#stage canvas{
  display: block;
  width: 100%;
  
  height: auto;
}


}

@media (max-width:575.98px){
  #canvasContainer{min-height: clamp(220px, 55vh, 65vh); padding:6px}
  .center-bar .btn{display:flex;flex-wrap: wrap; font-size:.95rem;padding:.45rem .65rem;width: 100%;max-width: 500px; justify-content: center;}
  .flex-wrap{display:flex;flex-wrap: wrap; font-size:.95rem;width: 100%;max-width: 500px; justify-content: space-between; }
  #canvasContainer.filled{
    padding:0 !important;
    min-height:0 !important;
    max-height:none !important;
  }
}

@media (max-width:505.98px){
  #canvasContainer{min-height: clamp(220px, 55vh, 65vh); padding:6px}
  .center-bar .btn{display:flex;flex-wrap: wrap; font-size:.95rem;padding:.45rem .65rem;width: 100%;max-width: 500px; justify-content: center;}
  .flex-wrap{display:flex;flex-wrap: wrap; font-size:.95rem;width: 100%;max-width: 500px; justify-content: space-between; }
  #canvasContainer.filled{
    padding:0 !important;
    min-height:0 !important;
    max-height:none !important;
  }
}

