:root{
  --brand:#0d6efd;
  --border:rgba(0,0,0,.12);
  --surface:#fff;
  --muted:#6c757d;
  --shadow:0 1px 2px rgba(0,0,0,.06), 0 6px 24px rgba(0,0,0,.06);
}

/* Header */
.app-header{display:flex;align-items:center;justify-content:center;width:100%;margin-top:1.5rem;margin-bottom:.5rem}
.app-title{display:flex;align-items:center;gap:.5rem;font-weight:700;color:var(--brand);font-size:clamp(1.2rem,2.2vw,1.6rem)}
.text-end,.text-end-1{display:flex;width:100%;justify-content:space-between;align-items:center}
.text-end-1{justify-content:flex-end}
.usuario{margin-right:.75rem;font-size:clamp(.95rem,1.6vw,1rem)}

/* Área de visualização – realmente fluida */
#canvasContainer{
  position:relative;
  background:#f8f9fa;
  border:1px dashed var(--border);
  border-radius:.75rem;
  padding:8px;
  min-height: clamp(200px, 250vh, 70vh);
  max-height: 82vh;
  overflow:auto;
}

/* Canvas: nunca display:none — esconda com visibility para manter dimensões */
#canvasContainer canvas{
  display:none;
  margin:0 auto;
  background:#fff;
  box-shadow:0 1px 2px rgba(0,0,0,.03);
}

#canvasContainer canvas.active{ display:block; }

/* quando há arquivo: container gruda no conteúdo (sem espaço sobrando) */
#canvasContainer.filled{
  background: transparent;
  border: none;
  padding: 0 !important;
  min-height: 0 !important;
  max-height: none !important;
  overflow: visible;
}


/* O retângulo é absoluto em relação ao #stage */
#stage{ width:100% !important;
  height:auto !important;position:relative;display: inline-block;     }
#canvasContainer.filled #stage{
  margin: 0 auto;           /* centraliza horizontalmente quando preenchido */
}
/* carimbo acima do canvas */
.retangulo{ z-index:20; }

/* alças de resize */
.retangulo .handle{
  position:absolute; width:14px; height:14px; background:#0d6efd;
  border:2px solid #fff; border-radius:50%; box-shadow:0 1px 3px rgba(0,0,0,.25);
}
.handle.br{ right:-8px; bottom:-8px; cursor:se-resize; }
.handle.tr{ right:-8px; top:-8px;    cursor:ne-resize; }
.handle.bl{ left:-8px;  bottom:-8px; cursor:sw-resize; }
.handle.tl{ left:-8px;  top:-8px;    cursor:nw-resize; }
/* Carimbo (posição/tamanho definidos por ratio via JS) */
.retangulo{
  touch-action: none;
  position:absolute;
  border:2px dashed var(--brand);
  border-radius:.5rem;
  background:rgba(13,110,253,.08);
  box-shadow:0 4px 18px rgba(38,136,228,.2);
  cursor:move; user-select:none;
  display:none;
  min-width:96px;             /* pisos para telas muito pequenas */
  min-height:72px;
  touch-action:none;          /* previne scroll durante o drag por toque */
  -webkit-tap-highlight-color: transparent;
}


/* Garanta que clique/toque “chegue” no carimbo */
.retangulo {
    touch-action: none;
    -webkit-user-select: none;
    user-select: none;
  }

.retangulo .stamp-content{
  pointer-events:auto !important;
  display:flex;flex-direction:column;justify-content:center;align-items:center;
  height:100%;padding:.5rem .75rem;text-align:center;color:#0d6efd;
  line-height:1.25;font-size:clamp(.75rem,1.5vw,.95rem);
}
.retangulo .stamp-title{font-weight:700;margin-bottom:.25rem;color:#0948c5}

/* Resultado */
.viewer{border:1px solid var(--border);border-radius:10px;background:#fff;padding:8px;margin-top:16px}
.pdf-frame{width:100%;height:clamp(56vh,70vh,82vh);border:none;border-radius:8px}
.img-preview{max-width:100%;height:auto;border-radius:8px;display:block;margin:0 auto}

/* Barra de centralização */
.center-bar{display:flex;flex-wrap:wrap;gap:.5rem;margin-bottom:.75rem}
.center-bar .btn{display:flex;align-items:center;gap:.5rem; justify-content: space-between;}
.flex-wrap{display:flex;flex-wrap: wrap; font-size:.95rem;width: 100%;max-width: 500px; justify-content: space-between; }

/* Responsivo */
@media (max-width:992px){
  .app-header{flex-direction:column;align-items:flex-start;gap:.5rem}
  .app-title img{width:40px;height:40px}
  /* Limite real do editor no desktop e centralizado */
  #canvasContainer {
    max-width: 1000px;   /* ajuste aqui 960/1000/1100 etc. */
    margin: 0 auto;
  }
}

#stage { width: 100%; }

/* Canvas sempre cabendo no container, sem estourar */
#stage canvas {
  width: 100% !important;
  height: auto !important;
  display: block;
}


@media (max-width:575.98px){
  #canvasContainer{min-height: clamp(220px, 55vh, 65vh); padding:6px}
  .center-bar .btn{display:flex;flex-wrap: wrap; font-size:.95rem;padding:.45rem .65rem;width: 100%;max-width: 500px; justify-content: center;}
  .flex-wrap{display:flex;flex-wrap: wrap; font-size:.95rem;width: 100%;max-width: 500px; justify-content: space-between; }
  #canvasContainer.filled{
    padding:0 !important;
    min-height:0 !important;
    max-height:none !important;
  }
}

@media (max-width:505.98px){
  #canvasContainer{min-height: clamp(220px, 55vh, 65vh); padding:6px}
  .center-bar .btn{display:flex;flex-wrap: wrap; font-size:.95rem;padding:.45rem .65rem;width: 100%;max-width: 500px; justify-content: center;}
  .flex-wrap{display:flex;flex-wrap: wrap; font-size:.95rem;width: 100%;max-width: 500px; justify-content: space-between; }
  #canvasContainer.filled{
    padding:0 !important;
    min-height:0 !important;
    max-height:none !important;
  }
}

